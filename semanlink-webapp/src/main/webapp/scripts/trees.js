// sur une base de longwell pour le fonctionnement des arbres// avec du XMLHttpRequest pour son chargement.// suppose definie la fct liveTreeLoadSubTree() qui retourne quelque chose genre :// "http://127.0.0.1:8080/semanlink/loadsubtree.do" @see template.jsp// author fps// sert a avoir la bonne image (ouvert/ferme)function makeConsistent(id,element) {	var trigger = document.getElementById("trigger:" + id);	if (trigger) {	    if ((element.style.display != "none") && (trigger.src.indexOf('closed') > -1)) {	        trigger.src = trigger.src.replace(/closed/gi,"open");	    } else if ((element.style.display == "none") && (trigger.src.indexOf('open') > -1)) {	        trigger.src = trigger.src.replace(/open/gi,"closed");	    }	}}function toggle(id) {    var block = document.getElementById("block:" + id);	if (block.innerHTML == "") {		// alert("load the subtree");		// block.innerHTML = "<li>aaaa</li><li>bbb</b>";		// block.innerHTML = retrieveURL(urlToRetrieve.value)	} else {		with (block.style) {			if (display=="none") {				display="block";			} else {				display="none";			}		}	}    // sert a avoir la bonne image (ouvert/ferme)	makeConsistent(id,block);}// pour un livetree// param id par ex 1_1_2// param encodedId l'uri du kw, encodee// postTagOnClick true si le href doit avoir un onclick avec un post pour cas du pulldown du livesearch en edit=true// targetUri : 2020-02 TagAndTagfunction toggle2(id, encodedId, withDocs, postTagOnClick, targetUri) {	// alert(id + ":" + encodedId);    var block = document.getElementById("block:" + id);	if (!block) { // the subtree has not been downloaded yet		// alert("load the subtree" + encodedId);		// ci-dessous : le & devrait etre encode, non ?		var arg = liveTreeLoadSubTree() + "?kwuri=" + encodedId +'&divid=' + id;		if (withDocs == 'true') arg = arg + "&withdocs=true";		if (postTagOnClick == 'true') arg = arg + "&postTagOnClick=true";		if (targetUri) arg = arg + "&targeturi=" + encodeURIComponent(targetUri);		retrieveURL(arg , id); // debug ok	} else {		with (block.style) {			if (display=="none") {				display="block";			} else {				display="none";			}		}	    // sert a avoir la bonne image (ouvert/ferme)		makeConsistent(id,block);	}}var searchStr = "";////   AJAX POUR LE LIVETREE DEBUT//var req;var theId;var isIE=false;// why asynchronous calls? Would have been much easier using synchronous calls.// see toggle2function retrieveURL(url, id) {	// alert(url);	theId = id;	if (window.XMLHttpRequest) { // Non-IE browsers		req = new XMLHttpRequest();		req.onreadystatechange = processStateChange;		try {			req.open("GET", url, true);		} catch (e) {			alert(e);		}	  req.send(null);	} else if (window.ActiveXObject) { // IE		isIE = true;		req = new ActiveXObject("Microsoft.XMLHTTP");		if (req) {			req.onreadystatechange = processStateChange;			req.open("GET", url, true);			req.send();		}	}}function processStateChange() {	if (req.readyState == 4) { // Complete	  if (req.status == 200) { // OK response		var mother_li = document.getElementById('li:' + theId);		var innerli = mother_li.innerHTML;		innerli += '<ul id="block:' +theId+ '" class="livetree">';		innerli += req.responseText;		innerli += '</ul>';		mother_li.innerHTML = innerli;			    // sert a avoir la bonne image (ouvert/ferme)		var block = document.getElementById("block:" + theId);		makeConsistent(theId,block);		var highlight = document.getElementById("LSHighlight");		if (highlight) {			// le changer			highlight.removeAttribute("id"); // set the hilite to false			son = highlight.firstChild.nextSibling.nextSibling.firstChild;			if (!isIE) {				highlight = son.nextSibling;			} else {				highlight = son;			}			highlight.setAttribute("id","LSHighlight");		}		// 2019-09		displayCommentAsMarkdown()	  } else {		alert("Problem: " + req.statusText);	  }	}}  ////   AJAX POUR LE LIVETREE FIN//  ////////////////////////////////////////////// ceci n'a rien a voir avec les scripts precedents, juste mis l√† par paresse// LOAD IMAGEfunction loadImage(imageUri, imageLinkToPage) {	var img = document.getElementById("displayedimage");	img.src = imageUri;	var panel = document.getElementById("imagetobedisplayedpanel");	panel.style.display="block";	// ce qui suit est ok avec safari : on tombe sur le href. Mais avec firefox, prend le commentaire entre deux	// panel.firstChild.setAttribute("href",imageLinkToPage);	var theHref = document.getElementById("displayedimagehref");	theHref.setAttribute("href",imageLinkToPage);}function printVersion() {	var d = false;	d = document.getElementById("right");	if (d) {		d.style.display = "none";	}	d = document.getElementById("navcontainer");	if (d) {		d.style.display = "none";	}	d = document.getElementById("logo");	if (d) {		d.style.display = "none";	}	d = document.getElementById("file_info")	if (d) {		d.style.display = "none";	}	d = document.getElementById("aboutThisDoc")	if (d) {		d.style.display = "none";	}	d = document.getElementById("documenttags")	if (d) {		d.style.display = "none";	}	d = document.getElementById("middle")	if (d) {		d.id = "middleprint";	}}